---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by chenlongfa.
--- DateTime: 2024/8/5 16:29
---

local Class = require("Framework.Lua.Class")
local AIStateBase = require("CodeRefactoring.AI.StateMachines.AIStateBase")
local CycleInstanceDataManager = GameTableDefine.CycleInstanceDataManager
local UIView = require("Framework.UI.View") -- 当工具类使用
local Vector3 = CS.UnityEngine.Vector3
local UnityHelper = CS.Common.Utils.UnityHelper
local PERSON_ACTION = require("CodeRefactoring.Actor.PersonActionDefine")

---@class CycleInstanceBaseActorWorkState:AIStateBase
---@field m_owner CycleInstanceBaseActor
local CycleInstanceWorkerWork = Class("CycleInstanceWorkerWork",AIStateBase)

function CycleInstanceWorkerWork:ctor()

end

function CycleInstanceWorkerWork:OnEnter(...)
    local actor = self.m_owner
    local actorData = actor.data
    -- 初始化在工作点
    local face = actorData.actFaceTr

    actor.gameObject.transform.position = actorData.actPosTr.position
    UnityHelper.RotateTowards(actor.gameObject.transform, Vector3(face.position.x, actorData.actPosTr.position.y, face.position.z))

    -- 播放动画
    local furLevelCfg = CycleInstanceDataManager:GetCurrentModel():GetFurlevelConfigByRoomFurIndex(actorData.roomId, 1)
    actor:SetAnimator(PERSON_ACTION[furLevelCfg.action])
    -- 显示气泡
    actor:SetTheDisplayOfBubbles("product")
end

function CycleInstanceWorkerWork:OnExit()

end

return CycleInstanceWorkerWork